/* Generated from JavaScript source files. Do not modify directly. */
window.LabelBlanc=window.LabelBlanc||{},window.LabelBlanc.SaveAndThen=window.LabelBlanc.SaveAndThen||{},function(a){function b(a){return d.html(a).text()}var c=window.LabelBlanc.SaveAndThen,d=a("<div/>");a(function(){var b=c.config,d=a("#post");b&&d.length&&new c.PostEditForm(d,b)}),c.PostEditForm=function(a,b){if(b.actions&&0!==b.actions.length){this.$form=a,this.config=b,this.action=null;var d=this.getDefaultAction();1!==b.actions.length||b.actions[0].enabled||(this.config.newButtonSetIsDummy=!0,d=b.actions[0]),this.$actionInput=this.createActionInput(),this.$originalPublishButton=this.getOriginalPublishButton(),this.newPublishButtonSet=new c.PublishButtonSet(this),this.$spinner=this.$form.find("#publishing-action .spinner"),this.setupForm(),this.setupOriginalPublishButton(),this.newPublishButtonSet.setAction(d),this.setupFormListeners(),this.setupWordpressListeners(),this.newPublishButtonSet.hideMenu(),this.insertNewPublishButtonSet(),this.setupSpinner(),this.config.newButtonSetIsDummy&&this.newPublishButtonSet.disable(!0)}},c.PostEditForm.LAST_USED_COOKIE_NAME="lb-sat-last-used-action",c.PostEditForm.prototype={getOriginalPublishButton:function(){return this.$form.find("#publish")},setupSpinner:function(){this.$spinner.addClass("lb-sat-spinner"),this.$originalPublishButton.before(this.$spinner)},insertNewPublishButtonSet:function(){var b=this.newPublishButtonSet.$container,c=a('<div class="lb-sat-separator"></div>');this.config.setAsDefault?this.$originalPublishButton.after(b).after(c):this.$originalPublishButton.before(b).before(c)},createActionInput:function(){return a('<input type="hidden" name="'+c.HTTP_PARAM_ACTION+'" />')},setupForm:function(){this.$form.prepend(this.$actionInput)},setupOriginalPublishButton:function(){this.config.setAsDefault&&!this.config.newButtonSetIsDummy&&this.$originalPublishButton.removeClass("button-primary").removeAttr("accesskey")},setAction:function(a){this.action=a,wpCookies.set(c.PostEditForm.LAST_USED_COOKIE_NAME,a.id,31536e3),this.$actionInput.val(a.id)},getAction:function(){return this.action},submit:function(){this.setAction(this.newPublishButtonSet.getAction());var b=a.Event("lb-save-and-then:submit");this.$form.trigger(b,this),b.isDefaultPrevented()||(this.$form.data("lbsat-button-submitted",!0),this.getOriginalPublishButton().click())},setupFormListeners:function(){var a=this;this.$form.on("submit.lbsat-post-edit",function(b){var c=a.$form.data("lbsat-button-submitted");a.$form.removeData("lbsat-button-submitted"),b.isDefaultPrevented()||c===!0&&a.newPublishButtonSet.$container.before(a.$spinner)})},getDefaultAction:function(){var b,d=this.config.defaultActionId,e=null;if(a.each(this.config.actions,function(a,c){if(c.enabled)return b=c,!1}),!d)return b;if(c.ACTION_LAST_ID===d){var f=wpCookies.get(c.PostEditForm.LAST_USED_COOKIE_NAME);if(!f)return b;d=f}return e=this.getActionFromId(d),e&&e.enabled||(e=b),e},getActionFromId:function(b){var c=null;return a.each(this.config.actions,function(a,d){if(d.id===b)return c=d,!1}),c},setupWordpressListeners:function(){var b=this;this.$form.on("click.lbsat-post-edit",":submit, a.submitdelete, #post-preview",function(c){var d=a(this);d.hasClass("disabled")||d.hasClass("submitdelete")||d.is("#post-preview")||b.$form.one("submit.lbsat-post-edit",function(a){a.isDefaultPrevented()||b.newPublishButtonSet.disable(!0)})}),a(document).on("autosave-disable-buttons.edit-post",function(){b.newPublishButtonSet.disable(!0)}).on("autosave-enable-buttons.edit-post",function(){wp.heartbeat&&wp.heartbeat.hasConnectionError()||b.config.newButtonSetIsDummy||b.newPublishButtonSet.disable(!1)}),this.$form.on("click","#post-visibility-select .cancel-post-visibility,#post-visibility-select .save-post-visibility,#timestampdiv .cancel-timestamp,#timestampdiv .save-timestamp,#post-status-select .save-post-status,#post-status-select .cancel-post-status",function(){b.newPublishButtonSet.updateLabels()})}},c.PublishButtonSet=function(a){this.postEditForm=a,this.config=this.postEditForm.config,this.action=null,this.$mainButton=this.createMainButton(),this.$dropdownButton=this.createDropdownButton(),this.$dropdownMenu=this.createDropdownMenu(),this.$container=this.createContainer(),this.setupDocumentClickListener(),this.setupMainButtonListeners(),this.setupDropdownButtonListeners(),this.setupDropdownMenuListeners()},c.PublishButtonSet.prototype={createMainButton:function(){var b=a('<button type="button"/>');return b.attr("class","button button-large lb-sat-main-button"),this.config.setAsDefault&&!this.config.newButtonSetIsDummy?b.addClass("button-primary"):b.removeAttr("accesskey"),b},createDropdownButton:function(){var b=a('<input type="button" value="&#xf140;" />');return b.attr("class",this.$mainButton.attr("class")),b.removeClass("lb-sat-main-button").addClass("lb-sat-dropdown-button"),b},createDropdownMenu:function(){var c=a('<ul class="lb-sat-dropdown-menu"></ul>'),d=this;return a.each(this.config.actions,function(e,f){var g=a('<li data-lb-sat-value="'+f.id+'">'+d.generateButtonLabel(f.buttonLabelPattern)+"</li>");f.title&&g.attr("title",b(f.title)),f.enabled?g.data("lbSatActionData",f):g.addClass("disabled"),c.append(g)}),c},createContainer:function(){var b=a('<span class="lb-sat-container"></span>');return b.append(this.$mainButton),this.config.actions.length>1&&b.addClass("lb-sat-with-dropdown").append(this.$dropdownButton).append(this.$dropdownMenu),this.config.setAsDefault&&b.addClass("lb-sat-set-as-default"),b},setupDocumentClickListener:function(){var b=this;a(document).click(function(){b.menuShown()&&b.hideMenu()})},setupMainButtonListeners:function(){var b=this;this.$mainButton.click(function(){a(this).hasClass("disabled")||b.config.newButtonSetIsDummy||b.postEditForm.submit()})},setupDropdownButtonListeners:function(){var a=this;this.$dropdownButton.click(function(b){a.menuShown()||(a.showMenu(),b.stopPropagation())})},setupDropdownMenuListeners:function(){var b=this;this.$dropdownMenu.on("click","li",function(){a(this).hasClass("disabled")||b.config.newButtonSetIsDummy||(b.setAction(a(this).data("lbSatActionData")),b.$mainButton.click())})},menuShown:function(){return this.$container.hasClass("lb-sat-dropdown-menu-shown")},showMenu:function(){this.$container.addClass("lb-sat-dropdown-menu-shown")},hideMenu:function(){this.$container.removeClass("lb-sat-dropdown-menu-shown")},setAction:function(a){this.action=a,this.updateLabels()},getAction:function(){return this.action},updateLabels:function(){var c=this;this.$mainButton.html(this.generateButtonLabel(this.action.buttonLabelPattern)),this.$mainButton.attr("title",b(this.action.title?this.action.title:"")),a.each(this.config.actions,function(a,b){var d=c.$dropdownMenu.find('[data-lb-sat-value="'+b.id+'"]');d.html(c.generateButtonLabel(b.buttonLabelPattern))})},generateButtonLabel:function(a){return a.replace("%s",this.postEditForm.$originalPublishButton.val())},disable:function(a){this.$mainButton.toggleClass("disabled",a),this.$dropdownButton.toggleClass("disabled",a)}}}(jQuery);